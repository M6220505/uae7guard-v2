[phases.setup]
nixPkgs = ["nodejs_20", "python3"]

[phases.install]
cmds = ["npm ci --legacy-peer-deps"]

[phases.build]
cmds = ["npm run build || echo 'Build failed, will use dev mode'"]

[start]
cmd = "if [ -f dist/index.cjs ]; then npm run start; else npm run dev; fi"
